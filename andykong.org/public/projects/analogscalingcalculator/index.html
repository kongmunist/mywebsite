<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Andy Kong">
    <meta name="title" content="Analog Signal Scaling">
    <meta name="description" content="Taming an unruly analog signal into a more manageable size.">

<title> Analog Signal Scaling | Andy Kong</title>

<style>
    .projectpage h1, .projectpage h2{
        color: #E0B890;
    }

    .projectpage img{
        max-width: 100%;
        max-height: 50vh;
        height: auto;
        width: auto;
        border-radius: 0;
    }
</style>


    <style type="text/css">
        /* Atkinson Hyperlegible */
        /* latin-ext
        @font-face {
          font-family: 'Atkinson Hyperlegible';
          font-style: normal;
          font-weight: 400;
          src: url("/static/atkhyp_latext.woff2") format('woff2');
          unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
        } */
        /* latin */
        @font-face {
          font-family: 'Atkinson Hyperlegible';
          font-style: normal;
          font-weight: 400;
          src: url("/static/atkhyp_lat.woff2") format('woff2');
          unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }


    </style>
    <link rel="stylesheet" type="text/css" href="/static/bootstrap.min.css">

    <script src="/static/fontawesome.js" defer></script>

    <script src="/static/instantpage-5.1.0.js" type="module" defer></script>




    <style>
        body {
            background: #202222;
            font-size: 1.1em;
            font-family: 'Atkinson Hyperlegible', sans-serif;
            color: #FAEADB;
            overflow-x: hidden;

            word-spacing: 0.03em;
        }

        .navlinks{
            font-family: 'Atkinson Hyperlegible';
            font-size: 1.1em;
        }

        h1, h2, h3, h4, h5, h6{
            font-family: "Atkinson Hyperlegible";
        }


        a {
            transition: color .05s linear;
            color:#00B4CC;
        }

        a:hover {
            color:#00DFFC;
            text-decoration: none;
        }

        .navbar-custom {
            font-size: 22px;
            background-color: #202222 !important;
        }

        .navbar-custom .navbar-brand{
            font-size: 30px;
            color: #00dffc !important;
        }

        .navbar-custom .navitem{
            color:#00dffc !important;
        }

        .navitem:hover{
            color:#00b4cc !important;
            text-decoration: none;
        }
        
        /* External link cursor for Github and Twitter */
        .navbar-custom a[target="_blank"] {
            cursor: alias;
        }

        .hidden{
          display: none;
        }

        .navbar-toggler-icon {
          border: none;
          outline: none;
        }

        .caption{
            font-size:12px;
            text-align: center;
            font-style: italic;
            margin-bottom: .2em;
            margin-top: 1em;
        }


        hr{
            background-color:white !important;
        }

        .video-container {
          position: relative;
          width: 100%;
          padding-bottom: 56.25%;
        }

        .youtubevideo {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          border: 0;
        }

        code {
          font-family: Consolas,"courier new";
          color: #110000;
          background-color: #FAEADB;
          padding: 2px;
          font-size: 105%;
        }


        .addpic {
            display: block;
            margin-left: auto;
            margin-right: auto;
            max-width: 100%;
            border-radius: 0;
        }

</style>


    <link rel="icon" type="image/png" href=" /static/aklogo.png " />

        <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-YNX5JQZWHT"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YNX5JQZWHT');
</script>
<script data-goatcounter="https://kong.goatcounter.com/count"
                    async src="//gc.zgo.at/count.js"></script>
    
</head>



<body>


<nav class="navbar navbar-expand-md navbar-dark bg-dark navbar-custom">
    <a class="navbar-brand" aria-label="Link to homepage in the navbar" style="height:50px; padding-left:10px;" href="/"><img src="/static/aklogo.png" alt="Andy Kong's logo" height="50px" style="margin-top:0px;margin-bottom:10px" /></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon hidden" style="background-color:#00b4cc;">
      <i class="fab fa-buffer fa-2x" style="color:#00b4cc; ">
          </span>
        </i>
    </button>

    <div class="collapse navbar-collapse " id="navbarSupportedContent" style="margin-left:25px;margin-top:10px">
        <ul class="navbar-nav ml-auto navlinks">
            <li class="nav-item">
                <a class="nav-link navitem" href="https://github.com/kongmunist" target="_blank" title="Github">Github</a>
            </li>
            <li class="nav-item">
                <a class="nav-link navitem" href="https://twitter.com/oldestasian" target="_blank" title="twitter">Twitter</a>
            </li>
            <li class="nav-item"></li>
                <a class="nav-link navitem" href="/now/" >[Now]</a>
            </li>
            <li class="nav-item">
                <a class="nav-link navitem" href="/blog/" >[Blog]</a>
            </li>
        </ul>
    </div>
</nav>



<div class="overflow-hidden" style = "height:100vh; width: 100vw; padding: 0px 1em 0px 1em;">
        <div class="projectpage" style="max-width:50em; margin-bottom:4em; margin-left:auto; margin-right:auto;">
            <h1 style="margin-bottom: 5px">Analog Signal Scaling</h1>
                <i><p style="margin-bottom: 5px; margin-top: 0px">Taming an unruly analog signal into a more manageable size.</p></i>
                <p style="margin-bottom: 0px; margin-top: 0px">Timespan: December 2020</p>
                <p style="margin-bottom: 5px; margin-top: 0px">Published: 2020-12-12</p>

                <hr>
            <html><body><p><img loading="lazy" class="d-block mx-auto" src="/static/analogscalinggraphic.png"/></p>
<p class="caption">Mapping analog voltages between two rails</p>
<p>This webpage is the live calculator I made for the analog scaling problem I highlighted in <a href="/blog/analogscalingvoltages/">this blog post</a>. It solves the problem of moving an analog signal within one voltage range to another voltage range with one op-amp. </p>
<p>Here, an example is set up scaling Â±15V sensor output to 0-5V Arduino/microcontroller analogRead-able values.</p>
<hr/>
<h3>Circuit setup</h3>
<p><img loading="lazy" class="d-block mx-auto" src="/static/scalingvoltage_nonumbers.png"/></p>
<form id="voltageform">
<table style="width:100%">
<tr>
<td style="text-align:center">
                Vin Ranges:</td><td> Low rail: <input id="1" size="8" value="-15"/> V <br/>High rail:<input id="2" size="8" value="15"/> V
            </td>
</tr>
<tr><td>&amp;nbsp</td></tr>
<tr>
<td style="text-align:center">
                Desired Vout Range: </td><td> Low rail: <input id="3" size="8" value="0"/> V <br/>High rail: <input id="4" size="8" value="5"/> V
                <!-- Vout high rail: </td><td> Vout high rail: <input id="4"> -->
</td>
</tr>
<br/>
</table>
</form>
<p><br/></p>
<hr/>
<h2 id="solution">Solution</h2>
<table width="50%">
<tr>
<td>
            Vref: </td><td>
<input disabled="" id="vref" size="8"/> V
        </td>
</tr>
<tr>
<td>
            R2/R1 ratio: </td><td>
<input disabled="" id="rratio" size="8"/>
</td>
</tr>
</table>
<p><br/></p>
<hr/>
<h3>Practical Implementation:</h3>
<p>To find real-world resistors that create this reference voltage or match this resistor ratio, you can visit <a href="http://jansson.us/resistors.html">this other calculator</a>, which I find invaluable. </p>
<p>Happy scaling!
<br/></p>
<hr/>
<h2 id="update-71121">Update 7/11/21</h2>
<p>I've used this calculator several times since I initially made this page, which makes it a success in my eyes. But I have had troubles selecting real components to make the actual circuit. The Vref is off by a few mV or the ratio is sorta right, but it's hard to tell how close is close enough by the numbers alone. </p>
<p>This update adds the reverse calculation of output voltage rails given the input voltage rails, Vref, and resistor ratio of the real components you've got to give you an idea of how accurate the output rails will be. </p>
<form id="reverseform">
<table style="width:100%">
<tr>
<td style="text-align:center">
                Vin rails: </td><td> Low rail: <input id="rev1" size="8" value="-15"/> V <br/> High rail:<input id="rev2" size="8" value="15"/> V
            </td>
<td>Vout rails: </td><td> Low rail: <input disabled="" id="revo1" size="8"/> V <br/> High rail:<input disabled="" id="revo2" size="8"/> V</td>
</tr>
<tr>
<td style="text-align:center">
                Vref: </td><td> <input id="rev3" size="8" value="2.14"/> V 
            </td>
</tr>
<tr>
<td style="text-align:center">
                R2/R1 ratio: </td><td> <input id="rev4" size="8" value="0.1666"/>
</td>
</tr>
</table>
</form>
<p><br/><br/></p>
<script> /////////////// Solves the forward simultaneous equations 
        // Input order is vin_low, vin_high, vout_low, vout_high
     function solveAnalogScaling(v1, v2, v3, v4){
        console.log("solving analog scale for vin_l, vin_h, vout_l, v_out_h: ", v1, v2, v3, v4);
        let v = (v2*v4 - v3*v1)/(v2 + v4 - v1 - v3);
        let r = (v-v3)/(v2 - v);
        console.log("Vref:", v, "Resistor ratio:", r);
        return [v, r]
     }

     function updateSoln(){
        v1 = parseFloat(document.getElementById("1").value);
        v2 = parseFloat(document.getElementById("2").value);
        v3 = parseFloat(document.getElementById("3").value);
        v4 = parseFloat(document.getElementById("4").value);
        if ([v1, v2, v3, v4].every(elem => !isNaN(elem))){
            tmp = solveAnalogScaling(v1, v2, v3, v4);
            document.getElementById("vref").value = tmp[0].toFixed(4);
            document.getElementById("rratio").value = tmp[1].toFixed(4);
        }
     }
    // Attach an event handler to the form above
    document.getElementById("voltageform").oninput = updateSoln;
    // run initial solution with default vals
    updateSoln();



    ////////////////// 7/11/21 Solves the reverse equations
    function updateReverseSoln(){
        vinHIGH = parseFloat(document.getElementById("rev1").value);
        vinLOW = parseFloat(document.getElementById("rev2").value);
        Vref = parseFloat(document.getElementById("rev3").value);
        rratio = parseFloat(document.getElementById("rev4").value);

        if ([vinHIGH, vinLOW, Vref, rratio].every(elem => !isNaN(elem))){
            lowRail = (Vref-vinHIGH)*rratio + Vref;
            highRail = (Vref-vinLOW)*rratio + Vref;
            document.getElementById("revo1").value = lowRail.toFixed(4);
            document.getElementById("revo2").value = highRail.toFixed(4);
        }
    }
    document.getElementById("reverseform").oninput = updateReverseSoln;
    updateReverseSoln();
</script></body></html>
        </div>
        <p style="line-height:300%;">&nbsp;</p>
</div>

<script src="/static/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="/static/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="/static/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

</body>
</html>